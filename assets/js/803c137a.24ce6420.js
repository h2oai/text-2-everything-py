"use strict";(globalThis.webpackChunksite=globalThis.webpackChunksite||[]).push([[905],{5531:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>u,frontMatter:()=>s,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"guides/feedback","title":"Feedback","description":"Manage feedback on chat messages and SQL executions to improve query quality and enable execution caching.","source":"@site/docs/guides/feedback.md","sourceDirName":"guides","slug":"/guides/feedback","permalink":"/text-2-everything-py/guides/feedback","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Feedback"},"sidebar":"defaultSidebar","previous":{"title":"Executions","permalink":"/text-2-everything-py/guides/executions"},"next":{"title":"Custom Tools","permalink":"/text-2-everything-py/guides/custom_tools"}}');var c=i(4848),a=i(8453);const s={title:"Feedback"},r=void 0,d={},o=[{value:"Basic Operations",id:"basic-operations",level:2},{value:"Create Feedback for Chat Message",id:"create-feedback-for-chat-message",level:3},{value:"Create Feedback for Execution",id:"create-feedback-for-execution",level:3},{value:"Helper Methods",id:"helper-methods",level:3},{value:"List Feedback",id:"list-feedback",level:3},{value:"Get Feedback",id:"get-feedback",level:3},{value:"Update Feedback",id:"update-feedback",level:3},{value:"Delete Feedback",id:"delete-feedback",level:3},{value:"Bulk Operations",id:"bulk-operations",level:2},{value:"Bulk Delete",id:"bulk-delete",level:3},{value:"Filtering and Querying",id:"filtering-and-querying",level:2},{value:"List by Sentiment",id:"list-by-sentiment",level:3},{value:"Get Feedback for Message",id:"get-feedback-for-message",level:3},{value:"Integration with Executions",id:"integration-with-executions",level:2},{value:"Feedback Workflow with Execution",id:"feedback-workflow-with-execution",level:3},{value:"Enabling Cache with Feedback",id:"enabling-cache-with-feedback",level:3},{value:"Complete Chat-Execute-Feedback Flow",id:"complete-chat-execute-feedback-flow",level:3},{value:"Feedback Impact on System",id:"feedback-impact-on-system",level:2},{value:"Cache Quality",id:"cache-quality",level:3},{value:"RAG Improvement",id:"rag-improvement",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Common Patterns",id:"common-patterns",level:2},{value:"User Validation Workflow",id:"user-validation-workflow",level:3},{value:"Feedback-Driven Cache",id:"feedback-driven-cache",level:3},{value:"Feedback Analytics",id:"feedback-analytics",level:3}];function l(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.p,{children:"Manage feedback on chat messages and SQL executions to improve query quality and enable execution caching."}),"\n",(0,c.jsx)(n.p,{children:"Feedback serves two key purposes:"}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Quality Improvement"}),": Help the system learn from user corrections"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Execution Caching"}),": Positive feedback marks executions as reliable for cache reuse"]}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"basic-operations",children:"Basic Operations"}),"\n",(0,c.jsx)(n.h3,{id:"create-feedback-for-chat-message",children:"Create Feedback for Chat Message"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'from text2everything_sdk import Text2EverythingClient\n\nclient = Text2EverythingClient(\n    base_url="https://...",\n    access_token="...",\n    workspace_name="workspaces/dev"\n)\n\n# Create positive feedback\nfeedback = client.feedback.create(\n    project_id="proj-123",\n    chat_message_id="msg-456",\n    feedback="The SQL query worked perfectly!",\n    is_positive=True\n)\n\nprint(f"Feedback created: {feedback.id}")\n'})}),"\n",(0,c.jsx)(n.h3,{id:"create-feedback-for-execution",children:"Create Feedback for Execution"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'# Link feedback to both chat message and execution\nfeedback = client.feedback.create(\n    project_id="proj-123",\n    chat_message_id="msg-456",\n    execution_id="exec-789",  # Link to execution\n    feedback="Query results are accurate and fast",\n    is_positive=True\n)\n\nprint(f"Feedback linked to execution: {feedback.execution_id}")\n'})}),"\n",(0,c.jsx)(n.h3,{id:"helper-methods",children:"Helper Methods"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'# Create positive feedback\npositive = client.feedback.create_positive(\n    project_id="proj-123",\n    chat_message_id="msg-456",\n    feedback_text="Excellent query!",\n    execution_id="exec-789"\n)\n\n# Create negative feedback\nnegative = client.feedback.create_negative(\n    project_id="proj-123",\n    chat_message_id="msg-456",\n    feedback="Query returned incorrect results",\n    execution_id="exec-789"\n)\n'})}),"\n",(0,c.jsx)(n.h3,{id:"list-feedback",children:"List Feedback"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'# List all feedback\nall_feedback = client.feedback.list(project_id="proj-123")\nfor fb in all_feedback:\n    status = "\ud83d\udc4d" if fb.is_positive else "\ud83d\udc4e"\n    print(f"{status} {fb.feedback}")\n\n# Search feedback\nsearch_results = client.feedback.list(\n    project_id="proj-123",\n    search="query"\n)\n\n# Pagination\npage1 = client.feedback.list(\n    project_id="proj-123",\n    skip=0,\n    limit=50\n)\n'})}),"\n",(0,c.jsx)(n.h3,{id:"get-feedback",children:"Get Feedback"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'feedback = client.feedback.get(\n    project_id="proj-123",\n    feedback_id="feedback-abc"\n)\n\nprint(f"Feedback: {feedback.feedback}")\nprint(f"Positive: {feedback.is_positive}")\nprint(f"Execution: {feedback.execution_id}")\n'})}),"\n",(0,c.jsx)(n.h3,{id:"update-feedback",children:"Update Feedback"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'updated = client.feedback.update(\n    project_id="proj-123",\n    feedback_id="feedback-abc",\n    feedback="Updated: The query was excellent!",\n    is_positive=True\n)\n'})}),"\n",(0,c.jsx)(n.h3,{id:"delete-feedback",children:"Delete Feedback"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'success = client.feedback.delete(\n    project_id="proj-123",\n    feedback_id="feedback-abc"\n)\n'})}),"\n",(0,c.jsx)(n.h2,{id:"bulk-operations",children:"Bulk Operations"}),"\n",(0,c.jsx)(n.h3,{id:"bulk-delete",children:"Bulk Delete"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'result = client.feedback.bulk_delete(\n    project_id="proj-123",\n    feedback_ids=["feedback-1", "feedback-2", "feedback-3"]\n)\n\nprint(f"Deleted {result[\'deleted_count\']} feedback entries")\nif result[\'failed_ids\']:\n    print(f"Failed: {result[\'failed_ids\']}")\n'})}),"\n",(0,c.jsx)(n.h2,{id:"filtering-and-querying",children:"Filtering and Querying"}),"\n",(0,c.jsx)(n.h3,{id:"list-by-sentiment",children:"List by Sentiment"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'# Get all positive feedback\npositive_feedback = client.feedback.list_positive(project_id="proj-123")\nprint(f"Found {len(positive_feedback)} positive feedback items")\n\n# Get all negative feedback\nnegative_feedback = client.feedback.list_negative(project_id="proj-123")\nprint(f"Found {len(negative_feedback)} negative feedback items")\n'})}),"\n",(0,c.jsx)(n.h3,{id:"get-feedback-for-message",children:"Get Feedback for Message"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'# Get all feedback for a specific chat message\nmessage_feedback = client.feedback.get_feedback_for_message(\n    project_id="proj-123",\n    chat_message_id="msg-456"\n)\n\nfor feedback in message_feedback:\n    print(f"Feedback: {feedback.feedback}")\n    print(f"Execution: {feedback.execution_id}")\n'})}),"\n",(0,c.jsx)(n.h2,{id:"integration-with-executions",children:"Integration with Executions"}),"\n",(0,c.jsx)(n.p,{children:"Feedback on executions is crucial for the execution cache system. Positive feedback marks executions as reliable for reuse."}),"\n",(0,c.jsx)(n.h3,{id:"feedback-workflow-with-execution",children:"Feedback Workflow with Execution"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'# 1. Execute a query\nresult = client.executions.execute_query(\n    project_id="proj-123",\n    connector_id="conn-456",\n    sql_query="SELECT * FROM customers WHERE status = \'active\'"\n)\n\n# 2. Present results to user\nprint(f"Query executed: {result.sql_query}")\nprint(f"Results: {result.result}")\n\n# 3. User provides feedback\n# If results are good, create positive feedback\nfeedback = client.feedback.create_positive(\n    project_id="proj-123",\n    chat_message_id=result.chat_message_id,  # From chat context\n    feedback_text="Perfect results!",\n    execution_id=result.execution_id\n)\n\n# This execution is now marked as reliable for cache reuse\n'})}),"\n",(0,c.jsx)(n.h3,{id:"enabling-cache-with-feedback",children:"Enabling Cache with Feedback"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'# Cache lookup favors executions with positive feedback\ncache_result = client.chat.execution_cache_lookup(\n    project_id="proj-123",\n    user_query="Show active customers",\n    connector_id="conn-456",\n    only_positive_feedback=True  # Only return executions with positive feedback\n)\n\nif cache_result.cache_hit:\n    for match in cache_result.matches:\n        if match.has_feedback and match.feedback_is_positive:\n            print(f"Using execution with positive feedback")\n            print(f"SQL: {match.execution[\'sql_query\']}")\n'})}),"\n",(0,c.jsx)(n.h3,{id:"complete-chat-execute-feedback-flow",children:"Complete Chat-Execute-Feedback Flow"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'# Create chat session\nsession = client.chat_sessions.create(project_id="proj-123")\n\n# Generate and execute SQL\nanswer = client.chat.chat_to_answer(\n    project_id="proj-123",\n    chat_session_id=session.id,\n    query="Count active users",\n    connector_id="conn-456"\n)\n\nif answer.execution_result:\n    # Store execution details\n    execution_id = answer.execution_result.execution_id\n    chat_message_id = answer.chat_message_id\n    \n    # Present results to user\n    print(f"SQL: {answer.sql_query}")\n    print(f"Results: {answer.execution_result.result}")\n    \n    # User validates results and provides feedback\n    user_satisfied = True  # User input\n    \n    if user_satisfied:\n        # Add positive feedback\n        feedback = client.feedback.create_positive(\n            project_id="proj-123",\n            chat_message_id=chat_message_id,\n            feedback_text="Results are accurate",\n            execution_id=execution_id\n        )\n        print("\u2705 Marked execution for cache reuse")\n    else:\n        # Add negative feedback with correction\n        feedback = client.feedback.create_negative(\n            project_id="proj-123",\n            chat_message_id=chat_message_id,\n            feedback="Results missing recent data - needs updated schema",\n            execution_id=execution_id\n        )\n        print("\u274c Execution marked for review")\n'})}),"\n",(0,c.jsx)(n.h2,{id:"feedback-impact-on-system",children:"Feedback Impact on System"}),"\n",(0,c.jsx)(n.h3,{id:"cache-quality",children:"Cache Quality"}),"\n",(0,c.jsx)(n.p,{children:"Positive feedback directly improves execution cache quality:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'# Without feedback filter - may include unreliable executions\ncache_result = client.chat.execution_cache_lookup(\n    project_id="proj-123",\n    user_query="sales data",\n    connector_id="conn-456"\n)\n\n# With feedback filter - only proven good executions\ncache_result = client.chat.execution_cache_lookup(\n    project_id="proj-123",\n    user_query="sales data",\n    connector_id="conn-456",\n    only_positive_feedback=True  # Higher quality results\n)\n'})}),"\n",(0,c.jsx)(n.h3,{id:"rag-improvement",children:"RAG Improvement"}),"\n",(0,c.jsx)(n.p,{children:"Feedback helps improve context retrieval in chat queries:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'# Generate SQL with feedback-enhanced RAG\nresponse = client.chat.chat_to_sql(\n    project_id="proj-123",\n    chat_session_id=session.id,\n    query="Show customer metrics",\n    feedback_cutoff=0.5  # Use feedback in retrieval\n)\n'})}),"\n",(0,c.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Execution Feedback"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Always link feedback to execution_id when available"}),"\n",(0,c.jsx)(n.li,{children:"Add positive feedback for verified correct results"}),"\n",(0,c.jsx)(n.li,{children:"Add negative feedback with specific issues for debugging"}),"\n",(0,c.jsx)(n.li,{children:"Use feedback to build reliable execution cache"}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Feedback Quality"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Provide specific, actionable feedback text"}),"\n",(0,c.jsx)(n.li,{children:"Include what was wrong or right"}),"\n",(0,c.jsx)(n.li,{children:"Reference specific data issues when applicable"}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Cache Optimization"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Filter cache by positive feedback in production"}),"\n",(0,c.jsx)(n.li,{children:"Review negative feedback to improve queries"}),"\n",(0,c.jsx)(n.li,{children:"Monitor feedback rates to assess system quality"}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"Bulk Operations"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Use bulk_delete for cleanup operations"}),"\n",(0,c.jsx)(n.li,{children:"Handle failed deletions appropriately"}),"\n",(0,c.jsx)(n.li,{children:"Check deleted_count vs expected count"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"common-patterns",children:"Common Patterns"}),"\n",(0,c.jsx)(n.h3,{id:"user-validation-workflow",children:"User Validation Workflow"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'def execute_with_validation(client, project_id, session_id, query, connector_id):\n    """\n    Execute query and collect user feedback.\n    """\n    # Execute\n    answer = client.chat.chat_to_answer(\n        project_id=project_id,\n        chat_session_id=session_id,\n        query=query,\n        connector_id=connector_id\n    )\n    \n    if not answer.execution_result:\n        return None\n    \n    # Present to user\n    print(f"SQL: {answer.sql_query}")\n    print(f"Results: {answer.execution_result.result}")\n    \n    # Collect feedback\n    user_rating = input("Rate this result (good/bad): ").lower()\n    user_comment = input("Comments (optional): ")\n    \n    # Record feedback\n    if user_rating == "good":\n        client.feedback.create_positive(\n            project_id=project_id,\n            chat_message_id=answer.chat_message_id,\n            feedback_text=user_comment or "Results validated",\n            execution_id=answer.execution_result.execution_id\n        )\n    elif user_rating == "bad":\n        client.feedback.create_negative(\n            project_id=project_id,\n            chat_message_id=answer.chat_message_id,\n            feedback=user_comment or "Results incorrect",\n            execution_id=answer.execution_result.execution_id\n        )\n    \n    return answer.execution_result\n'})}),"\n",(0,c.jsx)(n.h3,{id:"feedback-driven-cache",children:"Feedback-Driven Cache"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'def smart_query(client, project_id, connector_id, user_query):\n    """\n    Use cache with feedback, fall back to execution.\n    """\n    # Try cache with positive feedback only\n    cache_result = client.chat.execution_cache_lookup(\n        project_id=project_id,\n        user_query=user_query,\n        connector_id=connector_id,\n        only_positive_feedback=True,\n        similarity_threshold=0.8\n    )\n    \n    if cache_result.cache_hit and cache_result.matches:\n        best_match = cache_result.matches[0]\n        print(f"Using cached result (feedback score: \u2705)")\n        return best_match.execution[\'result\']\n    \n    # Execute new query\n    session = client.chat_sessions.create(project_id=project_id)\n    answer = client.chat.chat_to_answer(\n        project_id=project_id,\n        chat_session_id=session.id,\n        query=user_query,\n        connector_id=connector_id\n    )\n    \n    if answer.execution_result:\n        # Prompt for feedback to improve future cache\n        print("Please provide feedback to improve future results...")\n        return answer.execution_result.result\n    \n    return None\n'})}),"\n",(0,c.jsx)(n.h3,{id:"feedback-analytics",children:"Feedback Analytics"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'# Analyze feedback patterns\nall_feedback = client.feedback.list(project_id="proj-123")\n\npositive_count = sum(1 for f in all_feedback if f.is_positive)\nnegative_count = len(all_feedback) - positive_count\n\nprint(f"Positive: {positive_count} ({positive_count/len(all_feedback)*100:.1f}%)")\nprint(f"Negative: {negative_count} ({negative_count/len(all_feedback)*100:.1f}%)")\n\n# Review negative feedback for improvements\nnegative = [f for f in all_feedback if not f.is_positive]\nfor fb in negative:\n    print(f"Issue: {fb.feedback}")\n    print(f"Execution: {fb.execution_id}")\n'})})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(l,{...e})}):l(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>r});var t=i(6540);const c={},a=t.createContext(c);function s(e){const n=t.useContext(a);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:s(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);
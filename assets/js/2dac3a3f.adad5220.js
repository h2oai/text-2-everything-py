"use strict";(globalThis.webpackChunksite=globalThis.webpackChunksite||[]).push([[418],{8453:(e,t,n)=>{n.d(t,{R:()=>l,x:()=>r});var a=n(6540);const s={},i=a.createContext(s);function l(e){const t=a.useContext(i);return a.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),a.createElement(i.Provider,{value:t},e.children)}},9630:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>p,frontMatter:()=>l,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"guides/schema_metadata","title":"Schema Metadata","description":"Define tables, dimensions, metrics, and relationships for better SQL.","source":"@site/docs/guides/schema_metadata.md","sourceDirName":"guides","slug":"/guides/schema_metadata","permalink":"/text-2-everything-py/guides/schema_metadata","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Schema Metadata"},"sidebar":"defaultSidebar","previous":{"title":"Contexts","permalink":"/text-2-everything-py/guides/contexts"},"next":{"title":"Golden Examples","permalink":"/text-2-everything-py/guides/golden_examples"}}');var s=n(4848),i=n(8453);const l={title:"Schema Metadata"},r=void 0,c={},d=[{value:"Basic Operations",id:"basic-operations",level:2},{value:"Create table schema",id:"create-table-schema",level:3},{value:"Filter by type",id:"filter-by-type",level:3},{value:"Validation helpers",id:"validation-helpers",level:3},{value:"Working with Large Tables (Schema Splitting)",id:"working-with-large-tables-schema-splitting",level:2},{value:"What is Schema Splitting?",id:"what-is-schema-splitting",level:3},{value:"Understanding the Return Type",id:"understanding-the-return-type",level:3},{value:"Handling Split Results",id:"handling-split-results",level:3},{value:"Retrieving Split Groups",id:"retrieving-split-groups",level:3},{value:"Deletion Behavior",id:"deletion-behavior",level:3},{value:"Best Practices",id:"best-practices",level:3},{value:"See Also",id:"see-also",level:2}];function o(e){const t={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.p,{children:"Define tables, dimensions, metrics, and relationships for better SQL."}),"\n",(0,s.jsx)(t.h2,{id:"basic-operations",children:"Basic Operations"}),"\n",(0,s.jsx)(t.h3,{id:"create-table-schema",children:"Create table schema"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'schema = client.schema_metadata.create(\n    project_id=project.id,\n    name="Users Table",\n    schema_data={\n        "table": {\n            "name": "users",\n            "columns": [\n                {"name": "id", "type": "INTEGER"},\n                {"name": "email", "type": "VARCHAR(255)"}\n            ]\n        }\n    },\n)\n'})}),"\n",(0,s.jsx)(t.p,{children:"Create dimension:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'dimension = client.schema_metadata.create(\n    project_id=project.id,\n    name="User Status",\n    schema_data={\n        "table": {\n            "dimension": {\n                "name": "status",\n                "content": {"type": "categorical", "values": ["active","inactive"]}\n            }\n        }\n    },\n)\n'})}),"\n",(0,s.jsx)(t.p,{children:"Create metric:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'metric = client.schema_metadata.create(\n    project_id=project.id,\n    name="Total Revenue",\n    schema_data={\n        "table": {\n            "metric": {\n                "name": "total_revenue",\n                "content": {"aggregation": "sum", "column": "amount"}\n            }\n        }\n    },\n)\n'})}),"\n",(0,s.jsx)(t.p,{children:"Create relationship:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'relationship = client.schema_metadata.create(\n    project_id=project.id,\n    name="User Orders Relationship",\n    schema_data={\n        "relationship": {\n            "from_table": "users",\n            "to_table": "orders",\n            "from_column": "id",\n            "to_column": "user_id",\n            "type": "one_to_many"\n        }\n    },\n)\n'})}),"\n",(0,s.jsx)(t.p,{children:"List/get/update/delete:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'schemas = client.schema_metadata.list(project_id=project.id)\none = client.schema_metadata.get(project_id=project.id, schema_metadata_id=schema.id)\nupdated = client.schema_metadata.update(project_id=project.id, schema_metadata_id=schema.id, description="Updated")\nclient.schema_metadata.delete(project_id=project.id, schema_metadata_id=schema.id)\n'})}),"\n",(0,s.jsx)(t.h3,{id:"filter-by-type",children:"Filter by type"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'tables = client.schema_metadata.list_by_type(project.id, "table")\n'})}),"\n",(0,s.jsx)(t.h3,{id:"validation-helpers",children:"Validation helpers"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'errors = client.schema_metadata.validate_schema({"table": {"name": "users", "columns": []}}, "table")\nstype = client.schema_metadata.get_schema_type({"table": {"name": "users", "columns": []}})\n'})}),"\n",(0,s.jsx)(t.h2,{id:"working-with-large-tables-schema-splitting",children:"Working with Large Tables (Schema Splitting)"}),"\n",(0,s.jsx)(t.h3,{id:"what-is-schema-splitting",children:"What is Schema Splitting?"}),"\n",(0,s.jsxs)(t.p,{children:["When you create a table schema with ",(0,s.jsx)(t.strong,{children:"more than 8 columns"}),", the API automatically splits it into multiple parts. This improves RAG performance by creating smaller, more focused chunks for retrieval."]}),"\n",(0,s.jsx)(t.h3,{id:"understanding-the-return-type",children:"Understanding the Return Type"}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"create()"})," method returns:"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Single object"})," (",(0,s.jsx)(t.code,{children:"SchemaMetadataResponse"}),") for schemas with \u22648 columns"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"List"})," (",(0,s.jsx)(t.code,{children:"List[SchemaMetadataResponse]"}),") for schemas with >8 columns"]}),"\n"]}),"\n",(0,s.jsx)(t.h3,{id:"handling-split-results",children:"Handling Split Results"}),"\n",(0,s.jsx)(t.p,{children:"Always check the return type:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'result = client.schema_metadata.create(\n    project_id=project.id,\n    name="Large Customer Table",\n    schema_data={\n        "table": {\n            "name": "customers",\n            "columns": [\n                {"name": "id", "type": "INTEGER"},\n                {"name": "email", "type": "VARCHAR(255)"},\n                {"name": "first_name", "type": "VARCHAR(100)"},\n                {"name": "last_name", "type": "VARCHAR(100)"},\n                {"name": "phone", "type": "VARCHAR(20)"},\n                {"name": "address", "type": "VARCHAR(255)"},\n                {"name": "city", "type": "VARCHAR(100)"},\n                {"name": "state", "type": "VARCHAR(50)"},\n                {"name": "zip", "type": "VARCHAR(10)"},\n                {"name": "country", "type": "VARCHAR(50)"},\n            ]\n        }\n    }\n)\n\n# Handle both cases\nif isinstance(result, list):\n    print(f"Schema split into {len(result)} parts")\n    split_group_id = result[0].split_group_id\n    for part in result:\n        print(f"Part {part.split_index}/{part.total_splits}: {part.id}")\nelse:\n    print(f"Single schema created: {result.id}")\n'})}),"\n",(0,s.jsx)(t.h3,{id:"retrieving-split-groups",children:"Retrieving Split Groups"}),"\n",(0,s.jsx)(t.p,{children:"Get all parts of a split schema:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:"# Get complete split group information\nsplit_group = client.schema_metadata.get_split_group(\n    project_id=project.id,\n    split_group_id=split_group_id\n)\n\nprint(f\"Total parts: {split_group['total_parts']}\")\nfor part in split_group['parts']:\n    print(f\"Part {part.split_index}: {part.name}\")\n"})}),"\n",(0,s.jsx)(t.h3,{id:"deletion-behavior",children:"Deletion Behavior"}),"\n",(0,s.jsxs)(t.p,{children:["Deleting any part of a split schema ",(0,s.jsx)(t.strong,{children:"automatically deletes all parts"})," in the group:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:"# Delete just one part - all parts are removed\nclient.schema_metadata.delete(\n    project_id=project.id,\n    schema_metadata_id=result[0].id  # Deletes entire group\n)\n"})}),"\n",(0,s.jsx)(t.h3,{id:"best-practices",children:"Best Practices"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsxs)(t.strong,{children:["Always use ",(0,s.jsx)(t.code,{children:"isinstance()"})]})," to check if result is a list"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsxs)(t.strong,{children:["Store ",(0,s.jsx)(t.code,{children:"split_group_id"})]})," if you need to retrieve all parts later"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Delete any single part"})," - no need to delete each part individually"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Consider column organization"})," - group related columns in first 8 for better relevance"]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"see-also",children:"See Also"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"How To \u2192 Bulk Operations"}),": Learn about ",(0,s.jsx)(t.code,{children:"bulk_create()"})," with split schemas"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"How To \u2192 Validation"}),": Required nested fields validation"]}),"\n"]})]})}function p(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}}}]);